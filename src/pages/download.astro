---
import Layout from '../layouts/Layout.astro';
---

<Layout
  title="Download - Neon Injector"
  description="Download Neon Injector v1.3 to customize Mobile Legends skins effortlessly. Compatible with all Android devices running version 7.0 or higher."
>
  <div class="flex flex-col min-h-screen">
    <main class="flex-1 pt-16">
      <section class="container mx-auto px-4 py-16 text-[var(--text-color)]">
        <h1 class="text-4xl font-bold text-neon-purple mb-8 text-center">Download Neon Injector</h1>
        <div class="max-w-2xl mx-auto prose">
          <p class="mb-6">Get started with Neon Injector v1.3, the leading tool for safe and seamless Mobile Legends skin customization. Our lightweight APK is designed for optimal performance, offering a user-friendly interface and secure integration with Android devices. Download now to unlock a vast library of cosmetic skins and elevate your gaming experience.</p>
          
          <div class="bg-[var(--card-bg)] p-6 rounded-lg shadow-lg border border-neon-purple-dark mb-8">
            <h2 class="text-2xl font-semibold mb-4">Latest Version: v1.3</h2>
            <p class="mb-4">Neon Injector v1.3 brings enhanced features to make skin customization faster and more reliable. Key improvements include:</p>
            <ul class="list-disc list-inside space-y-2 mb-4">
              <li><strong>Faster Injection Speed</strong>: Up to 30% reduction in injection time for a smoother experience.</li>
              <li><strong>Improved Compatibility</strong>: Fully supports Mobile Legends v1.7.0 and newer.</li>
              <li><strong>Redesigned Skin Preview</strong>: Browse and select skins with an intuitive, modern interface.</li>
              <li><strong>Enhanced Stability</strong>: Reduced crashes and improved error handling for seamless operation.</li>
            </ul>
            <p class="mb-4">Ready to customize your heroes? Click below to download the APK and follow our installation guide.</p>
            
            <button
              id="download-btn"
              class="inline-block bg-neon-purple hover:bg-neon-purple-light text-white font-bold py-3 px-6 rounded-lg transition duration-300 cursor-pointer"
            >
              Download APK
            </button>

            <div id="download-progress-container" class="mt-4 hidden">
              <div class="w-full bg-[var(--card-bg)] rounded-full h-4 relative">
                <div 
                  id="progress-bar"
                  class="bg-neon-purple h-full rounded-full transition-all duration-300"
                  style="width: 0%;"
                ></div>
                <div id="progress-text" class="absolute inset-0 flex items-center justify-center text-sm text-white">0%</div>
              </div>
            </div>
            <p id="download-status" class="mt-2 text-sm hidden"></p>

            <p class="mt-4 text-sm">File Size: 4.5 MB | Last Updated: June 2025</p>
          </div>
          
          <h2 class="text-2xl font-semibold mb-4">System Requirements</h2>
          <p class="mb-4">To ensure Neon Injector runs smoothly on your device, please verify the following requirements:</p>
          <ul class="list-disc list-inside space-y-2 mb-6">
            <li><strong>Operating System</strong>: Android 7.0 (Nougat) or higher.</li>
            <li><strong>Memory</strong>: Minimum 2GB RAM for optimal performance.</li>
            <li><strong>Permissions</strong>: Storage Access Framework (SAF) or Shizuku permissions for secure file access.</li>
            <li><strong>Game Version</strong>: Mobile Legends v1.7.0 or newer installed.</li>
            <li><strong>Storage</strong>: At least 100MB of free storage space for the app and skin data.</li>
          </ul>
          
          <h2 class="text-2xl font-semibold mb-4 mt-8">Installation Guide</h2>
          <p class="mb-4">Follow these step-by-step instructions to install Neon Injector and start customizing your Mobile Legends skins:</p>
          <ol class="list-decimal list-inside space-y-3 mb-6">
            <li>Click the <strong>Download APK</strong> button above to begin downloading Neon Injector v1.3.</li>
            <li>Enable installation from unknown sources:
              <ul class="list-disc list-inside ml-6 space-y-2">
                <li>Go to <strong>Settings > Apps & Notifications > Special App Access > Install Unknown Apps</strong>.</li>
                <li>Allow your browser or file manager to install APKs.</li>
              </ul>
            </li>
            <li>Locate the downloaded <code>neon_injector_V_1.3.apk</code> file in your deviceâ€™s Downloads folder.</li>
            <li>Tap the APK file and follow the on-screen prompts to install Neon Injector.</li>
            <li>Open Neon Injector and grant necessary permissions (SAF or Shizuku) as guided in our <a href="/docs" class="text-neon-purple hover:text-neon-purple-light">Documentation</a>.</li>
            <li>Launch the app, browse the skin library, and start customizing your Mobile Legends heroes!</li>
          </ol>
          
          <h2 class="text-2xl font-semibold mb-4 mt-8">Safety and Support</h2>
          <p class="mb-4">To ensure a secure and smooth experience, please follow these recommendations:</p>
          <ul class="list-disc list-inside space-y-2 mb-6">
            <li><strong>Download from Official Sources</strong>: Only use the download link provided on this page to avoid malicious or unofficial APKs.</li>
            <li><strong>Use a Secondary Account</strong>: Test Neon Injector on a secondary Mobile Legends account to protect your main account from potential risks.</li>
            <li><strong>Stay Updated</strong>: Check for app updates regularly to maintain compatibility with Mobile Legends patches.</li>
            <li><strong>Seek Help</strong>: If you encounter issues, visit our <a href="/docs" class="text-neon-purple hover:text-neon-purple-light">Documentation</a> or contact our support team via the <a href="/contact" class="text-neon-purple hover:text-neon-purple-light">Contact page</a> or at <a href="mailto:support@neon-injector.my.id" class="text-neon-purple hover:text-neon-purple-light">support@neon-injector.my.id</a>.</li>
          </ul>
          
          <p class="mt-6 text-sm italic">Note: Neon Injector is a third-party tool for cosmetic skin modifications and does not alter gameplay. Using such tools may carry risks, including account bans. Please review our <a href="/disclaimer" class="text-neon-purple hover:text-neon-purple-light">Disclaimer</a> for more details.</p>
        </div>
      </section>
    </main>
  </div>

  <script>
    const downloadBtn = document.getElementById('download-btn');
    const progressBarContainer = document.getElementById('download-progress-container');
    const progressBar = document.getElementById('progress-bar');
    const progressText = document.getElementById('progress-text');
    const downloadStatus = document.getElementById('download-status');

    downloadBtn.addEventListener('click', async () => {
      // Sembunyikan tombol dan tampilkan progress bar
      downloadBtn.disabled = true;
      downloadBtn.style.opacity = 0.5;
      progressBarContainer.classList.remove('hidden');
      downloadStatus.classList.remove('hidden');
      downloadStatus.textContent = 'Memulai unduhan...';

      const url = 'https://neoninjector.my.id/neon_injector_V_1.3.apk';
      const fileName = 'neon_injector_V_1.3.apk';
      
      try {
        const response = await fetch(url);
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const contentLength = response.headers.get('Content-Length');
        const total = parseInt(contentLength, 10) || 0;
        let loaded = 0;
        const chunks = [];
        const reader = response.body.getReader();

        // Loop untuk membaca data secara bertahap (chunk)
        while (true) {
          const { done, value } = await reader.read();
          if (done) break;

          chunks.push(value);
          loaded += value.length;

          // Update progress bar
          const percentage = (loaded / total) * 100;
          progressBar.style.width = `${percentage}%`;
          progressText.textContent = `${percentage.toFixed(0)}%`;
          downloadStatus.textContent = `Mengunduh (${(loaded / 1048576).toFixed(2)} MB / ${(total / 1048576).toFixed(2)} MB)`;
        }

        // Setelah selesai, gabungkan chunk menjadi blob
        const blob = new Blob(chunks);
        downloadStatus.textContent = 'Unduhan selesai. Mempersiapkan file...';

        // Membuat link unduhan dan mengkliknya secara otomatis
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = fileName;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

        downloadStatus.textContent = 'File berhasil diunduh!';
        
        // Atur ulang tampilan setelah beberapa detik
        setTimeout(() => {
          progressBarContainer.classList.add('hidden');
          downloadStatus.classList.add('hidden');
          progressBar.style.width = '0%';
          progressText.textContent = '0%';
          downloadBtn.disabled = false;
          downloadBtn.style.opacity = 1;
        }, 5000);
        
      } catch (error) {
        console.error('Download failed:', error);
        downloadStatus.textContent = 'Unduhan gagal. Silakan coba lagi.';
        
        // Atur ulang tampilan jika ada error
        setTimeout(() => {
          progressBarContainer.classList.add('hidden');
          downloadStatus.classList.add('hidden');
          downloadBtn.disabled = false;
          downloadBtn.style.opacity = 1;
        }, 5000);
      }
    });
  </script>
</Layout>